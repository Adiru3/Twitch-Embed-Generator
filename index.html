<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twitch Embed Generator</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #6441a5 0%, #2a0845 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            text-align: center;
            color: #9146ff;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #bf94ff;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .input-section {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            background-color: rgba(255, 255, 255, 0.9);
        }
        
        button {
            padding: 12px 25px;
            background-color: #9146ff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #7c37e0;
        }
        
        .player-section {
            display: none;
            margin-bottom: 30px;
        }
        
        #twitch-player {
            width: 100%;
            height: 500px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .link-section {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .link-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        #embed-link {
            flex: 1;
            padding: 12px 15px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            font-family: monospace;
            word-break: break-all;
        }
        
        .copy-btn {
            background-color: #00a8ff;
        }
        
        .copy-btn:hover {
            background-color: #0097e6;
        }
        
        .info-box {
            background-color: rgba(255, 193, 7, 0.2);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .example {
            margin-top: 20px;
            font-size: 0.9em;
            color: #bf94ff;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-section {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .stats-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .stats-card {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-card h3 {
            color: #9146ff;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .online-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-item {
            background: rgba(145, 70, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #00ff88;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #bf94ff;
        }
        
        .streamer-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .streamer-list li {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background-color 0.3s;
        }
        
        .streamer-list li:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .streamer-list li:last-child {
            border-bottom: none;
        }
        
        .streamer-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #9146ff;
        }
        
        .streamer-info {
            flex-grow: 1;
        }
        
        .streamer-name {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .streamer-viewers {
            color: #00ff88;
            font-size: 14px;
        }
        
        .streamer-status {
            font-size: 12px;
            color: #bf94ff;
            padding: 3px 8px;
            border-radius: 12px;
            background: rgba(0, 255, 136, 0.1);
        }
        
        .refresh-btn {
            background-color: #6441a5;
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #bf94ff;
        }
        
        .no-data {
            text-align: center;
            padding: 20px;
            color: #ff6b6b;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            #twitch-player {
                height: 300px;
            }
            
            .online-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Twitch Embed Generator</h1>
        <div class="subtitle">Generate embeddable Twitch player links for any channel</div>
        
        <div class="input-section">
            <h2>Enter Twitch Channel Name</h2>
            <div class="input-group">
                <input type="text" id="channel-input" placeholder="Enter channel name (e.g., summit1g, shroud)">
                <button id="load-btn">Load Player</button>
            </div>
            <div class="example">Example: Enter "summit1g" for https://www.twitch.tv/summit1g</div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≠–¢–û–ô –°–¢–†–ê–ù–ò–¶–´ -->
        <div class="stats-section" id="stats-section">
            <div class="stats-title">
                <h2>üìä This Page Live Statistics</h2>
                <button class="refresh-btn" id="refresh-stats">üîÑ Refresh</button>
            </div>
            
            <div class="stats-grid">
                <div class="stats-card">
                    <h3>üëÅÔ∏è Page Activity</h3>
                    <div class="online-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="total-viewers">1</div>
                            <div class="stat-label">You Online</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="page-views">1</div>
                            <div class="stat-label">Total Views</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="active-streamers">0</div>
                            <div class="stat-label">Streamers</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="peak-online">1</div>
                            <div class="stat-label">Peak Online</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9em; color: #bf94ff; text-align: center;">
                        <p>üïí Your session: <span id="session-time">0s</span> | Updated: <span id="last-updated">now</span></p>
                    </div>
                </div>
                
                <div class="stats-card">
                    <h3>üî¥ Streamers Watching NOW</h3>
                    <ul class="streamer-list" id="streamer-list">
                        <li class="no-data">No one watching yet</li>
                    </ul>
                    <div style="margin-top: 10px; font-size: 0.8em; color: #aaa; text-align: center;">
                        <p>Shows streamers being watched on THIS PAGE</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="player-section" id="player-section">
            <h2>Twitch Player</h2>
            <div id="twitch-player"></div>
        </div>
        
        <div class="link-section" id="link-section">
            <h2>Embed Link</h2>
            <p>Use this link to embed the player or redirect bots:</p>
            <div class="link-container">
                <input type="text" id="embed-link" readonly>
                <button class="copy-btn" id="copy-btn">Copy</button>
            </div>
            <div class="info-box">
                <strong>How to use:</strong> Append <code>?channel=CHANNEL_NAME</code> to this page's URL. 
                Example: <code>https://your-username.github.io/repo-name/?channel=summit1g</code>
            </div>
        </div>
        
        <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ -->
        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
            <div style="display: flex; justify-content: center; gap: 25px; flex-wrap: wrap; margin-bottom: 10px;">
                <a href="https://github.com/Adiru3/Twitch-Embed-Generator" 
                   target="_blank" 
                   style="color: #bf94ff; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg style="width: 20px; height: 20px; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    Repository
                </a>
                
                <a href="https://github.com/Adiru3" 
                   target="_blank" 
                   style="color: #bf94ff; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg style="width: 20px; height: 20px; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    GitHub Profile
                </a>
                
                <a href="https://donatello.to/AdiruNetwork" 
                   target="_blank" 
                   style="color: #bf94ff; text-decoration: none; display: flex; align-items: center; gap: 8px;">
                    <svg style="width: 20px; height: 20px; fill: currentColor;" viewBox="0 0 24 24">
                        <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
                    </svg>
                    Donate
                </a>
            </div>
            <p style="color: rgba(255,255,255,0.6); font-size: 0.9em; margin-top: 5px;">
                Made with ‚òïÔ∏è by Adiru
            </p>
        </div>
    </div>


    <script src="https://player.twitch.tv/js/embed/v1.js"></script>
    <script>
        // Get channel from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        let channel = urlParams.get('channel');
        
        // DOM Elements
        const channelInput = document.getElementById('channel-input');
        const loadBtn = document.getElementById('load-btn');
        const playerSection = document.getElementById('player-section');
        const embedLink = document.getElementById('embed-link');
        const copyBtn = document.getElementById('copy-btn');
        const linkSection = document.getElementById('link-section');
        const refreshStatsBtn = document.getElementById('refresh-stats');
        
        // === –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–û–õ–¨–ö–û –≠–¢–û–ô –°–¢–†–ê–ù–ò–¶–´ ===
        let pageStats = {
            // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            currentViewer: generateViewerId(),
            currentStreamer: null,
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≤ LocalStorage –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏)
            totalPageViews: localStorage.getItem('twitchPageViews') ? parseInt(localStorage.getItem('twitchPageViews')) : 0,
            peakOnline: localStorage.getItem('twitchPeakOnline') ? parseInt(localStorage.getItem('twitchPeakOnline')) : 1,
            
            // –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∏–º–∏—Ç–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –¥–µ–º–æ)
            activeViewers: new Set([generateViewerId()]), // –ù–∞—á–∏–Ω–∞–µ–º —Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            watchingStreamers: {}, // streamer -> –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑—Ä–∏—Ç–µ–ª–µ–π
            
            // –í—Ä–µ–º—è
            sessionStartTime: Date.now(),
            lastUpdated: new Date().toLocaleTimeString()
        };
        
        // –ï—Å–ª–∏ –∫–∞–Ω–∞–ª —É–∫–∞–∑–∞–Ω –≤ URL, –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        if (channel) {
            channelInput.value = channel;
            loadPlayer(channel);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        initPageStats();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–µ—Å—Å–∏–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        setInterval(updateSessionTime, 1000);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        setInterval(updatePageStats, 10000);
        
        // –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–µ–µ—Ä–∞
        loadBtn.addEventListener('click', () => {
            const inputChannel = channelInput.value.trim();
            if (inputChannel) {
                // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                const newUrl = `${window.location.pathname}?channel=${encodeURIComponent(inputChannel)}`;
                window.history.pushState({}, '', newUrl);
                loadPlayer(inputChannel);
            } else {
                alert('Please enter a channel name');
            }
        });
        
        // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        refreshStatsBtn.addEventListener('click', () => {
            updatePageStats();
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä—É—á–Ω—É—é
            pageStats.lastUpdated = new Date().toLocaleTimeString();
            updateStatsUI();
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ Twitch –ø–ª–µ–µ—Ä–∞
        function loadPlayer(channelName) {
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–ª–µ–µ—Ä
            const playerDiv = document.getElementById('twitch-player');
            playerDiv.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø–ª–µ–µ—Ä
            const player = new Twitch.Player("twitch-player", {
                width: "100%",
                height: "100%",
                channel: channelName,
                parent: [window.location.hostname],
                autoplay: true
            });
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º embed —Å—Å—ã–ª–∫—É
            const currentUrl = window.location.origin + window.location.pathname;
            const embedUrl = `${currentUrl}?channel=${encodeURIComponent(channelName)}`;
            embedLink.value = embedUrl;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏–∏ –ø–ª–µ–µ—Ä–∞ –∏ —Å—Å—ã–ª–∫–∏
            playerSection.style.display = 'block';
            linkSection.style.display = 'block';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —á—Ç–æ —Å–º–æ—Ç—Ä–∏–º —ç—Ç–æ–≥–æ —Å—Ç—Ä–∏–º–µ—Ä–∞
            setWatchingStreamer(channelName);
        }
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ embed —Å—Å—ã–ª–∫–∏ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        copyBtn.addEventListener('click', () => {
            embedLink.select();
            embedLink.setSelectionRange(0, 99999);
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    const originalText = copyBtn.textContent;
                    copyBtn.textContent = 'Copied!';
                    copyBtn.style.backgroundColor = '#28a745';
                    
                    setTimeout(() => {
                        copyBtn.textContent = originalText;
                        copyBtn.style.backgroundColor = '';
                    }, 2000);
                }
            } catch (err) {
                navigator.clipboard.writeText(embedLink.value).then(() => {
                    const originalText = copyBtn.textContent;
                    copyBtn.textContent = 'Copied!';
                    copyBtn.style.backgroundColor = '#28a745';
                    
                    setTimeout(() => {
                        copyBtn.textContent = originalText;
                        copyBtn.style.backgroundColor = '';
                    }, 2000);
                });
            }
        });
        
        // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        channelInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loadBtn.click();
            }
        });
        
        // === –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ò –°–¢–†–ê–ù–ò–¶–´ ===
        
        function generateViewerId() {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            return 'viewer_' + Math.random().toString(36).substr(2, 9);
        }
        
        function initPageStats() {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            pageStats.totalPageViews++;
            localStorage.setItem('twitchPageViews', pageStats.totalPageViews);
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –¥–µ–º–æ
            simulateOtherViewers();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateStatsUI();
        }
        
        function simulateOtherViewers() {
            // –î–µ–º–æ: –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã—Ö "–¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
            const streamers = ['summit1g', 'shroud', 'xQc', 'pokimane', 'ninja'];
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö –∑—Ä–∏—Ç–µ–ª–µ–π (0-5 –¥–ª—è –¥–µ–º–æ)
            const otherViewersCount = Math.floor(Math.random() * 6);
            
            for (let i = 0; i < otherViewersCount; i++) {
                const viewerId = 'demo_viewer_' + i;
                pageStats.activeViewers.add(viewerId);
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Å—Ç—Ä–∏–º–µ—Ä
                const randomStreamer = streamers[Math.floor(Math.random() * streamers.length)];
                if (!pageStats.watchingStreamers[randomStreamer]) {
                    pageStats.watchingStreamers[randomStreamer] = 0;
                }
                pageStats.watchingStreamers[randomStreamer]++;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∏–∫ –æ–Ω–ª–∞–π–Ω
            if (pageStats.activeViewers.size > pageStats.peakOnline) {
                pageStats.peakOnline = pageStats.activeViewers.size;
                localStorage.setItem('twitchPeakOnline', pageStats.peakOnline);
            }
        }
        
        function updatePageStats() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
            pageStats.lastUpdated = new Date().toLocaleTimeString();
            
            // –°–∏–º—É–ª—è—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¥–ª—è –¥–µ–º–æ)
            simulateViewerActivity();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateStatsUI();
        }
        
        function simulateViewerActivity() {
            // –î–µ–º–æ: —Å–ª—É—á–∞–π–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º –∑—Ä–∏—Ç–µ–ª–µ–π
            const change = Math.random();
            
            if (change < 0.3 && pageStats.activeViewers.size < 10) {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –∑—Ä–∏—Ç–µ–ª—è
                const newViewer = 'new_viewer_' + Date.now();
                pageStats.activeViewers.add(newViewer);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫ —Å–ª—É—á–∞–π–Ω–æ–º—É —Å—Ç—Ä–∏–º–µ—Ä—É
                const streamers = Object.keys(pageStats.watchingStreamers);
                if (streamers.length > 0) {
                    const randomStreamer = streamers[Math.floor(Math.random() * streamers.length)];
                    pageStats.watchingStreamers[randomStreamer]++;
                }
                
            } else if (change > 0.7 && pageStats.activeViewers.size > 1) {
                // –£–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑—Ä–∏—Ç–µ–ª—è (–Ω–µ —Ç–µ–∫—É—â–µ–≥–æ)
                const viewersArray = Array.from(pageStats.activeViewers).filter(v => v !== pageStats.currentViewer);
                if (viewersArray.length > 0) {
                    const viewerToRemove = viewersArray[Math.floor(Math.random() * viewersArray.length)];
                    pageStats.activeViewers.delete(viewerToRemove);
                    
                    // –£–±–∏—Ä–∞–µ–º –∏–∑ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å—Ç—Ä–∏–º–µ—Ä–∞
                    const streamers = Object.keys(pageStats.watchingStreamers);
                    if (streamers.length > 0) {
                        const randomStreamer = streamers[Math.floor(Math.random() * streamers.length)];
                        if (pageStats.watchingStreamers[randomStreamer] > 0) {
                            pageStats.watchingStreamers[randomStreamer]--;
                            if (pageStats.watchingStreamers[randomStreamer] === 0) {
                                delete pageStats.watchingStreamers[randomStreamer];
                            }
                        }
                    }
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∏–∫ –æ–Ω–ª–∞–π–Ω
            if (pageStats.activeViewers.size > pageStats.peakOnline) {
                pageStats.peakOnline = pageStats.activeViewers.size;
                localStorage.setItem('twitchPeakOnline', pageStats.peakOnline);
            }
        }
        
        function setWatchingStreamer(streamerName) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ —Å–º–æ—Ç—Ä—è—â–µ–≥–æ —Å—Ç—Ä–∏–º–µ—Ä–∞
            pageStats.currentStreamer = streamerName;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            if (!pageStats.watchingStreamers[streamerName]) {
                pageStats.watchingStreamers[streamerName] = 0;
            }
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–ª—è —ç—Ç–æ–≥–æ —Å—Ç—Ä–∏–º–µ—Ä–∞
            pageStats.watchingStreamers[streamerName]++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateStatsUI();
        }
        
        function updateStatsUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const activeViewersCount = pageStats.activeViewers.size;
            const activeStreamersCount = Object.keys(pageStats.watchingStreamers).length;
            
            document.getElementById('total-viewers').textContent = activeViewersCount;
            document.getElementById('page-views').textContent = pageStats.totalPageViews.toLocaleString();
            document.getElementById('active-streamers').textContent = activeStreamersCount;
            document.getElementById('peak-online').textContent = pageStats.peakOnline;
            document.getElementById('last-updated').textContent = pageStats.lastUpdated;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∏–º–µ—Ä–æ–≤
            updateStreamerList();
        }
        
        function updateStreamerList() {
            const streamerList = document.getElementById('streamer-list');
            streamerList.innerHTML = '';
            
            const streamers = Object.entries(pageStats.watchingStreamers)
                .sort((a, b) => b[1] - a[1]);
            
            if (streamers.length === 0) {
                streamerList.innerHTML = '<li class="no-data">No streamers being watched on this page</li>';
                return;
            }
            
            streamers.forEach(([streamer, viewers]) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <img src="https://static-cdn.jtvnw.net/jtv_user_pictures/${streamer}-profile_image-70x70.png" 
                         alt="${streamer}" 
                         class="streamer-avatar"
                         onerror="this.src='https://static-cdn.jtvnw.net/jtv_user_pictures/xarth/404_user_70x70.png'">
                    <div class="streamer-info">
                        <div class="streamer-name">${streamer}</div>
                        <div class="streamer-viewers">${viewers} viewer${viewers !== 1 ? 's' : ''} on this page</div>
                    </div>
                    <div class="streamer-status">WATCHING</div>
                `;
                streamerList.appendChild(li);
            });
        }
        
        function updateSessionTime() {
            const sessionSeconds = Math.floor((Date.now() - pageStats.sessionStartTime) / 1000);
            const minutes = Math.floor(sessionSeconds / 60);
            const seconds = sessionSeconds % 60;
            document.getElementById('session-time').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            // –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–¥–∞–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (pageStats.currentStreamer && pageStats.watchingStreamers[pageStats.currentStreamer]) {
                pageStats.watchingStreamers[pageStats.currentStreamer]--;
                if (pageStats.watchingStreamers[pageStats.currentStreamer] === 0) {
                    delete pageStats.watchingStreamers[pageStats.currentStreamer];
                }
            }
            pageStats.activeViewers.delete(pageStats.currentViewer);
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            updateStatsUI();
            updateSessionTime();
        });
    </script>
</body>
</html>
